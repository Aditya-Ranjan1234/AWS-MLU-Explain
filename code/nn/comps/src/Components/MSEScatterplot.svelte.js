import{SvelteComponent as t,init as e,safe_not_equal as r,element as o,svg_element as s,empty as l,attr as n,add_render_callback as i,insert as c,append as a,add_resize_listener as f,noop as m,detach as d,destroy_each as h,component_subscribe as p,onMount as u,set_store_value as g,text as y,set_data as b,identity as $}from"../../node_modules/svelte/internal/index.mjs.js";import{tweened as x}from"../../node_modules/svelte/motion/index.mjs.js";import{mseData as k}from"../datasets.js";import{mseHeight as q,mseWidth as w,mseError as v,mseErrors as j,mseIteration as z,shuffleIteration as N,mseWeight as _,mseBias as M,RSS as B,TSS as D,rSquared as C}from"../store.js";import{format as E}from"../../node_modules/d3-format/src/defaultLocale.js";import H from"../../node_modules/d3-scale/src/linear.js";import I from"../../node_modules/d3-array/src/min.js";import L from"../../node_modules/d3-array/src/max.js";import R from"../../node_modules/d3-shape/src/line.js";function W(t,e,r){const o=t.slice();return o[20]=e[r],o}function A(t,e,r){const o=t.slice();return o[20]=e[r],o}function F(t,e,r){const o=t.slice();return o[25]=e[r],o}function G(t,e,r){const o=t.slice();return o[25]=e[r],o}function J(t){let e,r,o,l,i,f,m=t[8](t[25])+"";return{c(){e=s("g"),r=s("line"),l=s("text"),i=y(m),n(r,"class","grid-line svelte-zo58wb"),n(r,"x1","0"),n(r,"x2","0"),n(r,"y1","0"),n(r,"y2",o=-t[2]+t[7].bottom+t[7].top),n(r,"stroke","black"),n(r,"stroke-dasharray","4"),n(l,"class","axis-text svelte-zo58wb"),n(l,"y","15"),n(l,"text-anchor","middle"),n(e,"transform",f=`translate(${t[1](t[25])+0} ${t[2]-t[7].bottom})`)},m(t,o){c(t,e,o),a(e,r),a(e,l),a(l,i)},p(t,s){4&s&&o!==(o=-t[2]+t[7].bottom+t[7].top)&&n(r,"y2",o),2&s&&m!==(m=t[8](t[25])+"")&&b(i,m),6&s&&f!==(f=`translate(${t[1](t[25])+0} ${t[2]-t[7].bottom})`)&&n(e,"transform",f)},d(t){t&&d(e)}}}function K(t){let e,r,o,l,i,f,m=t[8](t[25])+"";return{c(){e=s("g"),r=s("line"),l=s("text"),i=y(m),n(r,"class","grid-line svelte-zo58wb"),n(r,"x1",5),n(r,"x2",o=t[4]-t[7].right),n(r,"y1","0"),n(r,"y2","0"),n(r,"stroke","black"),n(r,"stroke-dasharray","4"),n(l,"class","axis-text svelte-zo58wb"),n(l,"y","0"),n(l,"text-anchor","end"),n(l,"dominant-baseline","middle"),n(e,"transform",f=`translate(${t[7].left-5} ${t[0](t[25])+0})`)},m(t,o){c(t,e,o),a(e,r),a(e,l),a(l,i)},p(t,s){16&s&&o!==(o=t[4]-t[7].right)&&n(r,"x2",o),1&s&&m!==(m=t[8](t[25])+"")&&b(i,m),1&s&&f!==(f=`translate(${t[7].left-5} ${t[0](t[25])+0})`)&&n(e,"transform",f)},d(t){t&&d(e)}}}function O(t){let e,r,o,l,i;return{c(){e=s("rect"),n(e,"class","residual-rect svelte-zo58wb"),n(e,"x",r=t[20].price>t[20].y?t[1](t[20].sqft)-Number(Math.abs(t[0](t[20].y)-t[0](t[20].price))):t[1](t[20].sqft)),n(e,"y",o=t[20].price>t[20].y?t[0](t[20].price):t[0](t[20].y)),n(e,"height",l=Number(Math.abs(t[0](t[20].y)-t[0](t[20].price)))),n(e,"width",i=Number(Math.abs(t[0](t[20].y)-t[0](t[20].price))))},m(t,r){c(t,e,r)},p(t,s){11&s&&r!==(r=t[20].price>t[20].y?t[1](t[20].sqft)-Number(Math.abs(t[0](t[20].y)-t[0](t[20].price))):t[1](t[20].sqft))&&n(e,"x",r),9&s&&o!==(o=t[20].price>t[20].y?t[0](t[20].price):t[0](t[20].y))&&n(e,"y",o),9&s&&l!==(l=Number(Math.abs(t[0](t[20].y)-t[0](t[20].price))))&&n(e,"height",l),9&s&&i!==(i=Number(Math.abs(t[0](t[20].y)-t[0](t[20].price))))&&n(e,"width",i)},d(t){t&&d(e)}}}function P(t){let e,r,o;return{c(){e=s("circle"),n(e,"class","regression-circle svelte-zo58wb"),n(e,"fill","#c9208a"),n(e,"stroke","black"),n(e,"stroke-width","1.5"),n(e,"r","4.5"),n(e,"cx",r=t[1](t[20].sqft)),n(e,"cy",o=t[0](t[20].price))},m(t,r){c(t,e,r)},p(t,s){10&s&&r!==(r=t[1](t[20].sqft))&&n(e,"cx",r),9&s&&o!==(o=t[0](t[20].price))&&n(e,"cy",o)},d(t){t&&d(e)}}}function Q(t){let e,r,p,u,g,y,b,$,x,k,q,w,v=t[1].ticks(),j=[];for(let e=0;e<v.length;e+=1)j[e]=J(G(t,v,e));let z=t[0].ticks(),N=[];for(let e=0;e<z.length;e+=1)N[e]=K(F(t,z,e));let _=t[3],M=[];for(let e=0;e<_.length;e+=1)M[e]=O(A(t,_,e));let B=t[3],D=[];for(let e=0;e<B.length;e+=1)D[e]=P(W(t,B,e));return{c(){e=o("div"),r=s("svg");for(let t=0;t<j.length;t+=1)j[t].c();p=l();for(let t=0;t<N.length;t+=1)N[t].c();u=s("line"),b=s("line");for(let t=0;t<M.length;t+=1)M[t].c();x=s("path");for(let t=0;t<D.length;t+=1)D[t].c();n(u,"class","axis-line"),n(u,"y1",g=t[2]-t[7].bottom),n(u,"y2",y=t[2]-t[7].bottom),n(u,"x1",t[7].left),n(u,"x2",t[4]),n(u,"stroke","black"),n(u,"stroke-width","1"),n(b,"class","axis-line"),n(b,"y1",t[7].top),n(b,"y2",$=t[2]-t[7].bottom),n(b,"x1",t[7].left),n(b,"x2",t[7].left),n(b,"stroke","black"),n(b,"stroke-width","1"),n(x,"class","regression-line svelte-zo58wb"),n(x,"d",k=t[5](t[3])),n(r,"width",t[4]),n(r,"height",q=t[2]+t[7].top+t[7].bottom),n(e,"id","scatter-chart-mse"),n(e,"class","svelte-zo58wb"),i((()=>t[18].call(e)))},m(o,s){c(o,e,s),a(e,r);for(let t=0;t<j.length;t+=1)j[t].m(r,null);a(r,p);for(let t=0;t<N.length;t+=1)N[t].m(r,null);a(r,u),a(r,b);for(let t=0;t<M.length;t+=1)M[t].m(r,null);a(r,x);for(let t=0;t<D.length;t+=1)D[t].m(r,null);w=f(e,t[18].bind(e))},p(t,[e]){if(390&e){let o;for(v=t[1].ticks(),o=0;o<v.length;o+=1){const s=G(t,v,o);j[o]?j[o].p(s,e):(j[o]=J(s),j[o].c(),j[o].m(r,p))}for(;o<j.length;o+=1)j[o].d(1);j.length=v.length}if(401&e){let o;for(z=t[0].ticks(),o=0;o<z.length;o+=1){const s=F(t,z,o);N[o]?N[o].p(s,e):(N[o]=K(s),N[o].c(),N[o].m(r,u))}for(;o<N.length;o+=1)N[o].d(1);N.length=z.length}if(4&e&&g!==(g=t[2]-t[7].bottom)&&n(u,"y1",g),4&e&&y!==(y=t[2]-t[7].bottom)&&n(u,"y2",y),16&e&&n(u,"x2",t[4]),4&e&&$!==($=t[2]-t[7].bottom)&&n(b,"y2",$),11&e){let o;for(_=t[3],o=0;o<_.length;o+=1){const s=A(t,_,o);M[o]?M[o].p(s,e):(M[o]=O(s),M[o].c(),M[o].m(r,x))}for(;o<M.length;o+=1)M[o].d(1);M.length=_.length}if(40&e&&k!==(k=t[5](t[3]))&&n(x,"d",k),11&e){let o;for(B=t[3],o=0;o<B.length;o+=1){const s=W(t,B,o);D[o]?D[o].p(s,e):(D[o]=P(s),D[o].c(),D[o].m(r,null))}for(;o<D.length;o+=1)D[o].d(1);D.length=B.length}16&e&&n(r,"width",t[4]),4&e&&q!==(q=t[2]+t[7].top+t[7].bottom)&&n(r,"height",q)},i:m,o:m,d(t){t&&d(e),h(j,t),h(N,t),h(M,t),h(D,t),w()}}}function S(t,e,r){let o,s,l,n,i,c,a,f,m,d,h,y,b,W,A;p(t,q,(t=>r(2,n=t))),p(t,w,(t=>r(4,c=t))),p(t,v,(t=>r(10,a=t))),p(t,j,(t=>r(11,f=t))),p(t,z,(t=>r(12,m=t))),p(t,N,(t=>r(13,d=t))),p(t,_,(t=>r(14,h=t))),p(t,M,(t=>r(15,y=t))),p(t,B,(t=>r(16,b=t))),p(t,D,(t=>r(17,W=t))),p(t,C,(t=>r(19,A=t))),u((()=>{const t=document.getElementById("scatter-chart-mse").getBoundingClientRect();g(w,c=0==c?t.width:c,c),g(q,n=0==n?t.height:n,n)}));const F=x(k.map((t=>({sqft:t[`sqft${d}`],y:y+h*t[`sqft${d}`],price:t[`price${d}`]}))),{duration:200,easing:$});p(t,F,(t=>r(3,i=t)));const G={top:12,bottom:3,left:40,right:30},J=E(".2r");return t.$$.update=()=>{if(57344&t.$$.dirty&&F.set(k.map((t=>({sqft:t[`sqft${d}`],y:y+h*t[`sqft${d}`],price:t[`price${d}`]})))),261120&t.$$.dirty){g(z,m+=1,m);let t=k.map((t=>(t[`price${d}`]-(h*t[`sqft${d}`]+y))**2)),e=k.map((t=>t[`price${d}`])),r=e.reduce(((t,e)=>t+e))/e.length,o=k.map((t=>(t[`price${d}`]-r)**2));g(D,W=Number(o.reduce(((t,e)=>t+e),0)),W),g(B,b=Number(t.reduce(((t,e)=>t+e),0)),b),g(C,A=1-b/W,A),g(v,a=b/t.length,a),g(j,f=[...f,{iteration:m,error:a}],f)}53248&t.$$.dirty&&g(z,m+=1,m),24&t.$$.dirty&&r(1,o=H().domain([I(i,(t=>t.sqft))-2,L(i,(t=>t.sqft))+2]).range([G.left,c-G.right])),12&t.$$.dirty&&r(0,s=H().domain([I(i,(t=>t.price))-2,L(i,(t=>t.price))+2]).range([n-G.bottom,G.top])),3&t.$$.dirty&&r(5,l=R().x((t=>o(t.sqft))).y((t=>s(t.y))))},[s,o,n,i,c,l,F,G,J,function(){g(N,d=(d+1)%10,d),F.set(k.map((t=>({sqft:t[`sqft${d}`],y:y+h*t[`sqft${d}`],price:t[`price${d}`]})))),g(z,m=0,m),g(j,f=[{iteration:1,error:a}],f)},a,f,m,d,h,y,b,W,function(){c=this.offsetWidth,w.set(c),n=this.offsetHeight,q.set(n)}]}class T extends t{constructor(t){super(),e(this,t,S,Q,r,{shuffleData:9})}get shuffleData(){return this.$$.ctx[9]}}export{T as default};
